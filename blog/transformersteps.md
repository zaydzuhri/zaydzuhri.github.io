# step-by-step toy transformer calculation illustration

So I made this thing in response to when my advisor during my bachelor's thesis presentation said that not all people understand how transformers work. I did explain MLKV the best I could but, and there were already a lot of illustrations in the paper and slides, but I guess it wasn't enough. Yes I do agree that a concrete example helps a lot, I also had to do something like this years ago, but I do expect someone reading a paper on KV cache optimization to at least know what a transformer does. 

But well this image did go a bit viral on my twitter so I am happy that it can help some people. Below is the image but also you can look at the full res PNG [here](https://drive.google.com/file/d/1bns2hug5IxtEIcbJrHMyWnoXK7LaHA3k/view?usp=sharing), the source code for the calcs [here](https://github.com/zaydzuhri/pythia-mlkv/blob/main/steps.ipynb), and the draw.io project with a bunch of other goodies [here](https://app.diagrams.net/?page-id=8vaLYQQZe7K2jagj4tAL&title=mlkv.drawio#Uhttps%3A%2F%2Fdrive.google.com%2Fuc%3Fid%3D1bcUddFbCtNkxIEuNRtpj9WVpOsBuNPYy%26export%3Ddownload#%7B%22pageId%22%3A%228vaLYQQZe7K2jagj4tAL%22%7D).

<figure>
  <img src="media/transformersteps.jpg" alt="transformer steps" style="width:100%">
</figure>